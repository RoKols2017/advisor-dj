---
title: "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ Print Advisor"
type: analysis
date: 2025-01-30
owner: "@rom"
---

# üìä –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ Print Advisor

## üéØ –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** Print Advisor  
**–¢–∏–ø:** Django –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –ø–µ—á–∞—Ç–∏  
**–°—Ç–∞—Ç—É—Å:** MVP (draft)  
**–í–ª–∞–¥–µ–ª–µ—Ü:** @rom  

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~4,030 —Å—Ç—Ä–æ–∫ Python
- **–§–∞–π–ª–æ–≤ Python:** 66 —Ñ–∞–π–ª–æ–≤
- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏:** 78% (—Ü–µ–ª—å: 80%)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤:** 51 —Ç–µ—Å—Ç (100% –ø—Ä–æ—Ö–æ–¥—è—Ç)
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è Django:** 2 (accounts, printing)
- **–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:** 9 –º–æ–¥–µ–ª–µ–π

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

#### 1. **accounts/** ‚Äî –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –ö–∞—Å—Ç–æ–º–Ω–∞—è –º–æ–¥–µ–ª—å `User` (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è AbstractUser)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Active Directory (Windows-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
- –°–≤—è–∑—å —Å –æ—Ç–¥–µ–ª–∞–º–∏ (Department)
- –°–µ—Ä–≤–∏—Å—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`backends.py`, `services.py`)

#### 2. **printing/** ‚Äî –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- **–ú–æ–¥–µ–ª–∏:**
  - `PrintEvent` ‚Äî —Å–æ–±—ã—Ç–∏—è –ø–µ—á–∞—Ç–∏ (–æ—Å–Ω–æ–≤–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å)
  - `Printer`, `PrinterModel` ‚Äî –ø—Ä–∏–Ω—Ç–µ—Ä—ã –∏ –º–æ–¥–µ–ª–∏
  - `Department`, `Building` ‚Äî –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
  - `Computer`, `Port` ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏
- **Views:** Dashboard, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –∏–º–ø–æ—Ä—Ç, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- **Services:** –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
- **Watcher:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—Ç–∞–ª–æ–≥–∞ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Ñ–∞–π–ª–æ–≤

#### 3. **config/** ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ settings –ø–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º:
  - `base.py` ‚Äî –±–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  - `development.py` ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
  - `production.py` ‚Äî –ø—Ä–æ–¥–∞–∫—à–µ–Ω
  - `docker.py` ‚Äî Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ
  - `test.py` ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (`logging.py`)
- URL-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è (`urls.py`)

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**Backend:**
- Python 3.13
- Django 5.2.1
- PostgreSQL 15 (production) / SQLite (development)
- Gunicorn (WSGI —Å–µ—Ä–≤–µ—Ä)

**Frontend:**
- Django Templates
- Bootstrap 5
- django-tables2 (—Ç–∞–±–ª–∏—Ü—ã)
- django-filter (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
- django-import-export (–∏–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç)

**DevOps:**
- Docker & Docker Compose
- Nginx (reverse proxy)
- Watchdog (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤)
- Systemd (–∞–≤—Ç–æ–∑–∞–ø—É—Å–∫)

**–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:**
- ruff (–ª–∏–Ω—Ç–µ—Ä)
- black (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- mypy (—Ç–∏–ø–∏–∑–∞—Ü–∏—è, strict mode)
- pytest (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- pytest-cov (–ø–æ–∫—Ä—ã—Ç–∏–µ)

---

## üìà –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–µ—á–∞—Ç–∏**
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –ø–µ—á–∞—Ç–∏
   - –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞–Ω–∏—è—Ö
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º, –æ—Ç–¥–µ–ª–∞–º

2. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**
   - Dashboard —Å –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∑–∞ 30 –¥–Ω–µ–π
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—Ç–¥–µ–ª–∞–º –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
   - –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ –ø–µ—á–∞—Ç–∏ (–æ—Ç–¥–µ–ª ‚Üí –ø—Ä–∏–Ω—Ç–µ—Ä ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –¥–æ–∫—É–º–µ–Ω—Ç)
   - –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–∞–Ω–∏—Ü—ã, –¥–æ–∫—É–º–µ–Ω—Ç—ã, —Ä–∞–∑–º–µ—Ä)

3. **–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö**
   - –ò–º–ø–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ CSV (Active Directory)
   - –ò–º–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π –ø–µ—á–∞—Ç–∏ –∏–∑ JSON
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ watcher (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—Ç–∞–ª–æ–≥–∞)
   - –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ `job_id`

4. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**
   - –ö–∞—Å—Ç–æ–º–Ω–∞—è –º–æ–¥–µ–ª—å User —Å –§–ò–û –∏ –æ—Ç–¥–µ–ª–∞–º–∏
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Windows-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Å–æ–±—ã—Ç–∏–π

---

## üê≥ Docker-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–µ—Ä–≤–∏—Å—ã

1. **nginx** (reverse proxy)
   - –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (–ø–æ—Ä—Ç 80/443)
   - –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ web-—Å–µ—Ä–≤–∏—Å—É
   - SSL/TLS —Ç–µ—Ä–º–∏–Ω–∞—Ü–∏—è

2. **web** (Django –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
   - Gunicorn —Å 3 –≤–æ—Ä–∫–µ—Ä–∞–º–∏
   - Health check endpoint (`/health/`)
   - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ WhiteNoise
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª—ã –∏ –∫–æ–Ω—Å–æ–ª—å

3. **watcher** (–¥–µ–º–æ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞ `data/watch/`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ JSON/CSV —Ñ–∞–π–ª–æ–≤
   - –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤ `processed/` –∏–ª–∏ `quarantine/`

4. **db** (PostgreSQL 15)
   - –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (volume `pgdata`)
   - Health checks
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫

### –°–µ—Ç–∏ Docker

- `advisor-network` ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–µ—Ç—å –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `reverse-proxy-network` ‚Äî –æ–±—â–∞—è —Å–µ—Ç—å –¥–ª—è Nginx –∏ backend

---

## ‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –ø—Ä–æ–µ–∫—Ç–∞

1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
   - ‚úÖ –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (accounts, printing)
   - ‚úÖ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Å–µ—Ä–≤–∏—Å—ã
   - ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ settings –ø–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Django best practices

2. **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞**
   - ‚úÖ –¢–∏–ø–∏–∑–∞—Ü–∏—è (mypy strict mode)
   - ‚úÖ –õ–∏–Ω—Ç–∏–Ω–≥ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (ruff, black)
   - ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ 78% (–±–ª–∏–∑–∫–æ –∫ —Ü–µ–ª–∏ 80%)
   - ‚úÖ 51 —Ç–µ—Å—Ç, –≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

3. **DevOps**
   - ‚úÖ Docker-–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
   - ‚úÖ Health checks –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
   - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ (`restart: unless-stopped`)
   - ‚úÖ Nginx reverse proxy
   - ‚úÖ Makefile –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã

4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
   - ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–π README
   - ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
   - ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞
   - ‚úÖ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –ø–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ (RUNBOOK)

5. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
   - ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ `.env`
   - ‚úÖ CSRF –∑–∞—â–∏—Ç–∞ (–∫—Ä–æ–º–µ –∏–º–ø–æ—Ä—Ç–∞, —Å–º. –ø—Ä–æ–±–ª–µ–º—ã)
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –≤ Docker

6. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   - ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (Redis/Django cache)
   - ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ –≤–∞–∂–Ω—ã—Ö –ø–æ–ª—è—Ö (`job_id`, `timestamp`)
   - ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (`select_related`, `prefetch_related`)
   - ‚úÖ –ë–∞—Ç—á–∏–Ω–≥ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ (100 —Å–æ–±—ã—Ç–∏–π –∑–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é)

---

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–∏—Å–∫–∏

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —á–∞—Å—Ç–∏—á–Ω–æ)

1. ‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞—Ç –≤ PrintTreeView** ‚Äî –ò–°–ü–†–ê–í–õ–ï–ù–û
   - –ë—ã–ª–æ: —Ñ–∏–ª—å—Ç—Ä—ã –Ω–µ –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å
   - –°—Ç–∞–ª–æ: –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∞—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

2. ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ PrinterModel** ‚Äî –ò–°–ü–†–ê–í–õ–ï–ù–û
   - –ë—ã–ª–æ: –ø–æ–ª–µ `model` –Ω–µ –∑–∞–ø–æ–ª–Ω—è–ª–æ—Å—å
   - –°—Ç–∞–ª–æ: –ø–∞—Ä—Å–∏–Ω–≥ `model_code` —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –≤—Å–µ—Ö –ø–æ–ª–µ–π

3. ‚úÖ **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å job_id** ‚Äî –ò–°–ü–†–ê–í–õ–ï–ù–û
   - –ë—ã–ª–æ: –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª `unique=True`
   - –°—Ç–∞–ª–æ: –¥–æ–±–∞–≤–ª–µ–Ω `unique=True` –≤ –º–æ–¥–µ–ª–∏

4. ‚úÖ **–ò–Ω–¥–µ–∫—Å—ã** ‚Äî –ß–ê–°–¢–ò–ß–ù–û –ò–°–ü–†–ê–í–õ–ï–ù–û
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ `timestamp`, `job_id`, `document_id`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã `(user, timestamp)`, `(printer, timestamp)`

### –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
   - –¢–µ–∫—É—â–µ–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Å–æ–±—ã—Ç–∏–π
   - –†–∏—Å–∫: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –±–µ–∑ –§–ò–û –∏ –æ—Ç–¥–µ–ª–∞
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ CSV

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞**
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: 10 –ú–ë –¥–ª—è CSV, 50 –ú–ë –¥–ª—è JSON
   - ‚ö†Ô∏è –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ (–¥–ª—è JSON —á–µ—Ä–µ–∑ POST)

3. **CSRF –∑–∞—â–∏—Ç–∞ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞**
   - –¢–µ–∫—É—â–µ–µ: `csrf_exempt` –¥–ª—è `ImportPrintEventsView`
   - –†–∏—Å–∫: CSRF-–∞—Ç–∞–∫–∏ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (`IMPORT_TOKEN`)

### –ù–∏–∑–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (—É–ª—É—á—à–µ–Ω–∏—è)

1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏**
   - –õ–æ–≥–∏–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ —á–∞—Å—Ç–∏—á–Ω–æ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ `forms.py` –∏ `services.py`
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å—ã

2. **N+1 –∑–∞–ø—Ä–æ—Å—ã**
   - –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `select_related` / `prefetch_related`
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ N+1

3. **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥**
   - –ú–æ–¥–µ–ª—å `OrganizationalUnit` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
   - –ú–æ–¥—É–ª—å `printing/importers.py` ‚Äî —Ç–æ–Ω–∫–∏–µ –æ–±–µ—Ä—Ç–∫–∏
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å

4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**
   - –§–∞–π–ª `docs/concepts/architecture-notes.md` –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –¥–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

- **–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:** 78% (—Ü–µ–ª—å: 80%)
- **–¢–µ—Å—Ç—ã:** 51 —Ç–µ—Å—Ç (100% –ø—Ä–æ—Ö–æ–¥—è—Ç)
- **–¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤:**
  - Unit-—Ç–µ—Å—Ç—ã (models, views, services, forms, filters)
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (watcher)

### –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

- **ruff:** –Ω–∞—Å—Ç—Ä–æ–µ–Ω (E, F, I, B, UP, C4, SIM, TCH)
- **black:** –Ω–∞—Å—Ç—Ä–æ–µ–Ω (line-length=120)
- **mypy:** strict mode –≤–∫–ª—é—á–µ–Ω
- **–ò—Å–∫–ª—é—á–µ–Ω–∏—è:** –º–∏–≥—Ä–∞—Ü–∏–∏, —Ç–µ—Å—Ç—ã, staticfiles

### CI/CD

- ‚úÖ GitHub Actions –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –õ–∏–Ω—Ç–∏–Ω–≥ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
- ‚úÖ –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
- ‚úÖ Docker build
- ‚úÖ Smoke tests

---

## üîÑ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ó–∞–≤–µ—Ä—à–µ–Ω–æ (Stage 1-4)

- ‚úÖ **Stage 1:** Security & Settings ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- ‚úÖ **Stage 2:** Architecture & Performance ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –ø–æ –ø–ª–∞–Ω—É
- ‚úÖ **Stage 3:** Tests & Code Quality ‚Äî 78% coverage, 51 —Ç–µ—Å—Ç
- ‚úÖ **Stage 4:** DevOps/CI/CD ‚Äî Docker —Å—Ç–µ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç, CI –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### –í —Ä–∞–±–æ—Ç–µ

- ‚ö†Ô∏è **Production overlay:** reverse proxy/TLS –≤ —Ä–∞–±–æ—Ç–µ
- ‚ö†Ô∏è **Coverage:** –Ω—É–∂–Ω–æ –ø–æ–¥–Ω—è—Ç—å –¥–æ 80%+
- ‚ö†Ô∏è **Watcher tests:** —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è watcher

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è

- üìã DRF/OpenAPI –¥–ª—è API
- üìã –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏ (Prometheus/Grafana)
- üìã –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ)

1. ‚úÖ –ü–æ–¥–Ω—è—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –¥–æ 80%+
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è watcher
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å CSRF –∑–∞—â–∏—Ç—É –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ (—Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ N+1 –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ)

1. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
3. –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥ (`OrganizationalUnit`, `importers.py`)
4. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–£–ª—É—á—à–µ–Ω–∏—è)

1. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ –ø–µ—á–∞—Ç–∏ (–≤–æ–∑–º–æ–∂–Ω–æ, —á–µ—Ä–µ–∑ CTE)
2. –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –≤ StatisticsView
3. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
4. –£–ª—É—á—à–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö

---

## üìù –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

**–û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚úÖ **–•–æ—Ä–æ—à–µ–µ** (–≥–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É —Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∞–º–∏)

**–û—Ü–µ–Ω–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:**

- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5) ‚Äî —Ö–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5) ‚Äî —Ç–∏–ø–∏–∑–∞—Ü–∏—è, —Ç–µ—Å—Ç—ã, –ª–∏–Ω—Ç–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5) ‚Äî –±–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ –µ—Å—Ç—å, –Ω—É–∂–Ω—ã —É–ª—É—á—à–µ–Ω–∏—è
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5) ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã, –µ—Å—Ç—å —Ä–µ–∑–µ—Ä–≤
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5) ‚Äî —Ö–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, –µ—Å—Ç—å –ø—Ä–æ–±–µ–ª—ã
- **DevOps:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5) ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Docker –∏ CI/CD

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** 85%

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫–∏:**
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ DRF/OpenAPI (medium)
- Production overlay –≤ —Ä–∞–±–æ—Ç–µ (medium)
- –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ —á—É—Ç—å –Ω–∏–∂–µ —Ü–µ–ª–∏ (low)

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑](CRITICAL_ANALYSIS.md) ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –ø—Ä–æ–±–ª–µ–º
- [–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞](STATUS.md) ‚Äî —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∏ —Ä–∏—Å–∫–∏
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é](DEPLOYMENT_CHECKLIST.md) ‚Äî —á–µ–∫–ª–∏—Å—Ç –¥–ª—è –¥–µ–ø–ª–æ—è
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏](RUNBOOK.md) ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

---

*–ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω: 2025-01-30*  
*–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞: latest commit*
